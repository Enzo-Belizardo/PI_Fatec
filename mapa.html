<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa Interativo | FluxoCerto</title>
    <link rel="shortcut icon" href="imgs/icon_Logo.png" type="image/x-icon">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
    <s><link rel="stylesheet" href="./CSS/style.css"></s>
    
    <style>
        #map {
            height: 600px;
            width: 70%;
            border: 1px solid #ccc;
            border-radius: 10px;    
        }
        
        .leaflet-popup-content {
            font-family: Poppins;
            font-size: 14px;
        }

    </style>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                <a href="index.html"><img src="imgs/logo.png" alt="FluxoCerto_Logo"></a>
            </div>
            <ul class="menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="mapa.html">Mapa SP</a></li>
                <li><a href="doacaoUsuario.html">Doe Agora</a></li>
                <li><a href="login.html"><img src="imgs/perfil.svg" alt=""></a></li>
            </ul>
        </nav>
    </header>   
    
    <h1>Mapa Interativo de São Paulo</h1>
    
    <div id="map"></div>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var map = L.map('map').setView([-23.5505, -46.6333], 11); 
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);
            
            fetch('https://raw.githubusercontent.com/codigourbano/distritos-sp/master/distritos-sp.geojson')
                .then(response => response.json())
                .then(data => {
                    L.geoJSON(data, {
                        style: function(feature) {
                            return {
                                color: 'blue',          
                                fillColor: 'lightblue', 
                                fillOpacity: 0.5,       
                                weight: 2               
                            };
                        },
                        onEachFeature: function(feature, layer) {
                            var nomeDistrito = feature.properties.nome || feature.properties.name || 'Nome Distrito'; 
                            var infoDistrito = 'Informações adicionais: ' + (feature.properties.descricao || 'Tratamento de Esgoto, Gestão de Resíduos, etc.');
                            
                            layer.bindPopup('<h3>' + nomeDistrito + '</h3><p>' + infoDistrito + '</p>');
                            
                            layer.on('click', function(e) {
                                console.log('Distrito clicado: ' + nomeDistrito);
                            });
                        }
                    }).addTo(map);
                })
                .catch(error => {
                    console.error('Erro ao carregar o GeoJSON:', error);
                    alert('Não foi possível carregar os dados dos distritos. Verifique a URL ou a conexão.');
                });
        });
    </script>

    <h1>Ranking dos Bairros de São Paulo</h1>

    <div class="opcoes">
        <label for="filtro">Selecionar Filtro:</label>
        <select id="filtro">
            <option value="abastecimento">Abastecimento de Água</option>
            <option value="esgoto">Tratamento de Esgoto</option>
            <option value="residuos">Gestão de Resíduos</option>
        </select>
    </div>

    <table>
        <thead>
            <tr>
                <th>Posição</th>
                <th>Bairro</th>
                <th>Índice</th>
            </tr>
        </thead>
        <tbody id="body">
        
        </tbody>
    </table>

    <script>
        const dados = {
            abastecimento: [
                { bairro: "Pinheiros", valor: "99.8%" },
                { bairro: "Moema", valor: "99.5%" },
                { bairro: "Vila Mariana", valor: "99.2%" },
                { bairro: "Itaim Bibi", valor: "99.1%" },
                { bairro: "Perdizes", valor: "98.9%" },
                { bairro: "Santana", valor: "98.5%" },
                { bairro: "Butantã", valor: "98.1%" },
                { bairro: "Liberdade", valor: "97.9%" },
                { bairro: "Tatuapé", valor: "97.6%" },
                { bairro: "Consolação", valor: "97.2%" }
            ],
            esgoto: [
                { bairro: "Moema", valor: "98.7%" },
                { bairro: "Pinheiros", valor: "98.4%" },
                { bairro: "Vila Mariana", valor: "98.0%" },
                { bairro: "Tatuapé", valor: "97.5%" },
                { bairro: "Liberdade", valor: "97.1%" },
                { bairro: "Consolação", valor: "96.9%" },
                { bairro: "Perdizes", valor: "96.5%" },
                { bairro: "Itaim Bibi", valor: "96.2%" },
                { bairro: "Santana", valor: "95.8%" },
                { bairro: "Sé", valor: "95.1%" }
            ],
            residuos: [
                { bairro: "Vila Mariana", valor: "85.4%" },
                { bairro: "Pinheiros", valor: "84.9%" },
                { bairro: "Santo Amaro", valor: "84.3%" },
                { bairro: "Lapa", valor: "83.8%" },
                { bairro: "Tatuapé", valor: "82.7%" },
                { bairro: "Moema", valor: "81.9%" },
                { bairro: "Perdizes", valor: "80.5%" },
                { bairro: "Itaim Bibi", valor: "79.8%" },
                { bairro: "Sé", valor: "78.9%" },
                { bairro: "Butantã", valor: "78.2%" }
            ]
        };

        const selectFiltro = document.getElementById("filtro");
        const rankingBody = document.getElementById("body");

        function renderizarTabela(filtro) {
            const lista = dados[filtro];
            rankingBody.innerHTML = "";

            lista.forEach((item, index) => {
                const tr = document.createElement("tr");

                const tdPos = document.createElement("td");
                tdPos.textContent = index + 1;

                const tdBairro = document.createElement("td");
                tdBairro.textContent = item.bairro;

                const tdValor = document.createElement("td");
                tdValor.textContent = item.valor;

                tr.appendChild(tdPos);
                tr.appendChild(tdBairro);
                tr.appendChild(tdValor);

                rankingBody.appendChild(tr);
            });
        }

        selectFiltro.addEventListener("change", () => {
            renderizarTabela(selectFiltro.value);
        });

        renderizarTabela(selectFiltro.value);
    </script>

    <footer class="footer_mini">
        <a href="sobre.html">Sobre Nós</a>
        <div class="redes_footer_mini">
            <p>Acompanhe as nossas redes sociais!</p>
            <a href=""><img src="imgs/linkedin.png" alt="LinkedIn"></a>
            <a href=""><img src="imgs/instagram.png" alt="Instagram"></a>
        </div>
        <p>© 2025 FluxoCerto - Todos os direitos reservados</p>
    </footer>
</body>
</html>