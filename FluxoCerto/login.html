<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login | FluxoCerto</title>
    <link rel="shortcut icon" href="imgs/icon_Logo.png" type="image/x-icon">
    <link rel="stylesheet" href="./CSS/style.css">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                <a href="index.html"><img src="imgs/logo.png" alt="FluxoCerto_Logo"></a>
            </div>
            <ul class="menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="mapa.html">Mapa SP</a></li>
                <li><a href="doacaoUsuario.html">Doe Agora</a></li>
            </ul>
        </nav>
    </header>   
    <div class="containerlogin">
        <div class="login_container">
            <h2>Login</h2>
            <p>Entre na sua conta agora e participe da nossa comunidade.</p>

            <form id="formLogin" class="form_login">
                <input type="email" name="email" placeholder="E-mail:" required>
                <input type="password" name="senha" placeholder="Senha:" required>
                <button type="submit" class="btn_login">Entrar</button>
            </form>
            <p class="texto_cadastrado">
                N√£o √© cadastrado? <a href="cadastro.html">Clique Aqui!</a>
            </p>
        </div>
    </div>

    <div id="notificacoes"></div>

    <script>
        const formLogin = document.getElementById("formLogin");

        function mostrarToast(mensagem, tipo = "aviso") {
            const container = document.getElementById("notificacoes");
            const toast = document.createElement("div");
            toast.classList.add("toast", tipo);

            let icone = "üí¨";
            if (tipo === "sucesso") icone = "‚úÖ";
            if (tipo === "erro") icone = "‚ùå";
            if (tipo === "aviso") icone = "‚ö†Ô∏è";

            toast.innerHTML = `<span class="icone">${icone}</span><span>${mensagem}</span>`;
            container.appendChild(toast);

            setTimeout(() => toast.remove(), 3500);
        }

        if (formLogin) {
            formLogin.addEventListener("submit", function (e) {
                e.preventDefault();

                const email = e.target.email.value.trim().toLowerCase();
                const senha = e.target.senha.value;

                const usuarios = JSON.parse(localStorage.getItem("usuarios")) || [];

                if (usuarios.length === 0) {
                    mostrarToast("Nenhum usu√°rio cadastrado. Por favor, cadastre-se primeiro!", "aviso");
                    return;
                }

                const usuarioEncontrado = usuarios.find(u => u.email === email && u.senha === senha);

                if (usuarioEncontrado) {
                    localStorage.setItem("usuarioLogado", JSON.stringify(usuarioEncontrado));
                    mostrarToast(`Bem-vindo(a), ${usuarioEncontrado.nome}! Redirecionando...`, "sucesso");

                    setTimeout(() => {
                        window.location.href = "index.html";
                    }, 1500);
                } else {
                    mostrarToast("E-mail ou senha incorretos!", "erro");
                }
            });
        }
    </script>
</body>
</html>